概要
====

VMware ゲスト用汎用 コマンドラインユーティリティです。以下の機能があります：

  - ゲスト内の APM BIOS を通さずに VMware 仮想マシンの APM ファンクション
    を呼び出す

  - ホスト・ゲスト間のテキストコピー＆ペースト

  - マウスカーソル位置の取得・設定

  - 仮想デバイス（フロッピ、CD など）の情報取得

  - 仮想デバイスの接続・切断

  - VMware GUI オプション設定（コピー&ペースト有無など）の取得・設定

  - 仮想マシンおよびホストの情報取得（仮想ハードウェアバージョン、メモリサ
    イズ、プロセッサ速度、画面サイズなど）

  - VMware ゲスト・ホスト間 RPC ファンクション呼び出し（仮想ディスクシュリ
    ンク、ログメッセージ出力など）

  - ホストシステム時刻取得、ゲストシステム時刻同期


表記法
======

このテキストでは以下の略語を使用します：

    ESX         VMware ESX Server
    GSX         VMware GSX Server
    VM          仮想マシン
    WS          VMware Workstation

このテキストでは以下の表記規則を使用します：

    <value>     ユーザが指定する情報

    [option]    省略可能な項目

    [o1|o2|...] 省略可能な選択項目

    {c1|c2|...} 必須選択項目


全般的な使用法
==============

  vmw <コマンド> [-q|-c|-v][-d][-h][<コマンド固有オプション>]

    <コマンド> には、実行するコマンド名を指定します。
    以下のコマンドが使用可能です：

	a[pm]     APM ファンクションを実行します
	co[py]    テキストをクリップボードにコピーします
	cu[rsor]  マウスカーソル座標を取得・設定します
	d[evice]  デバイス情報・状態を取得・設定します
	h[wver]   仮想ハードウェアバージョンを取得します
	me[mory]  メモリサイズ (MB) を取得します
	mh[z]     プロセッサ速度 (MHz) を取得します
	o[ption]  オプション設定を取得・設定します
	p[aste]   クリップボードからテキストをペーストします
	r[pc]     ゲスト・ホスト間 RPC を実行します
	s[creen]  ホストスクリーンサイズを取得します
	t[ime]    ホストシステム時刻の取得・ゲストシステム時刻の同期
	u[uid]    BIOS UUID を取得します
	v[ersion] VMware バージョンを取得します

    一意に識別可能な範囲で、コマンドを短縮することができます。
    大文字・小文字は区別されます（コマンドは全て小文字で入力します）。

    以下のオプションは、全てのコマンドに共通です。ただし、コマンドによって
    は意味をなさない場合もあります:

      -q  quiet (テキスト出力なし)
      -c  curt (最低限のテキスト出力: デフォルト)
      -v  verbose (最大限のテキスト出力)
      -d  dump (全てのバックドア呼び出しについて各レジスタ内容をテキスト出力
          します)
      -h  ヘルプメッセージを表示します

    "vmw <command> -h" で各コマンドのヘルプが表示されます。

    オプションの大文字・小文字は区別されます。


コマンド "apm"
==============

  vmw apm [<共通オプション>] {-p|-s|<value>}

    VMware 仮想マシンの APM ファンクションを直接実行します。
    ゲスト内の APM BIOS は使用されません。

    -p      仮想マシンの電源をオフにします
    -s      仮想マシンをサスペンドします
    <value> APM ファンクション番号（上位ワード）とファンクション固有パラメー
            タ（下位ワード）を組み合わせた 32 ビット値を 16 進数で指定します。

    仮想マシンを -s オプションでサスペンドした場合、リジュームできなくなる
    場合があります（理由は不明です）。

    WS4.5/GSX3.2 以降では、このコマンドは仮想プロセッサが特権モードで動作して
    いる場合のみ使用可能です（リアルモード DOS、OS カーネルなど）。
    WS4.0/GSX2.5 以前ではそのような制限はありません。

  例:

    vmw apm -p        仮想マシンの電源をオフにします
    vmw apm 00070007  これも仮想マシンの電源をオフにします


コマンド "copy"
===============

  vmw copy [<共通オプション>] [<file>|-t<text>]

    テキストをホストのクリップボードにコピーします。

    <file>   コピーするテキストを読み込むファイルを指定します
    -t<text> コピーするテキストを直接指定します。空白文字が含まれる場合は
             "" で括ります。

    ファイル・テキストのどちらも指定されなかった場合はテキストを標準入力から
    読み込みます。

    コピーするテキストに改行コード以外の非 ASCII 文字を含めることはできません。
    ゲストおよびホスト OS によっては、キャリッジリターンの付与・除去が行われ
    ます。
    コピー可能なテキストの最大長は約 65,000 バイトです。

  例:

    vmw copy file.txt    file.txt の内容をクリップボードにコピーします
    vmw copy -tabcde     "abcde" をクリップボードにコピーします
    dir | vmw copy       "dir" コマンドの出力をクリップボードにコピーします


コマンド "cursor"
=================

  vmw cursor [<共通オプション>][{-r|-R}[<interval>]][-s<X>,<Y>]

    マウスカーソル座標を取得・設定します。

    -r  <interval> ミリ秒間隔で、何かキーが押されるまで繰り返します
        <interval> を省略した場合のデフォルトは 100 ミリ秒です
        -r と <interval> の間には空白を入れません

    -R  -r と同じですが、ターミナルの改行を抑制します

    -s  指定座標にカーソルを移動します
        <X> と <Y> の間のカンマは必須です
        -s、<X>、<Y> の間には空白を入れません

  例:

    vmw cursor -R     カーソル座標を継続的に取得し、ターミナルに表示します。
                      ターミナルは改行されません。

    vmw cursor -s0,0  カーソルをゲスト画面の左上隅に移動します


コマンド "device"
=================

  vmw device [<共通オプション>][+|-|/][<targets>]

    接続可能仮想デバイスの情報を取得します。
    仮想デバイスの接続・切断を実行します。

    +         <targets> で指定したデバイスを（再）接続します

    -         <targets> で指定したデバイスを切断します

    /         <targets> で指定したデバイスの接続状態を逆にします

    <targets> 対象デバイス番号を指定します。複数のデバイスを指定する場合は
              カンマで区切ります。
              'a' は「全て」という意味になります。
              省略した場合のデフォルトは全てのデバイスです。
              +,-,/ および <targets> の間には空白を入れません。

    +, -, / のいずれも指定されなかった場合、対象デバイスの現在の状態が表示
    されます。

  例:

    vmw device     全ての仮想デバイスの接続状態を表示します
    vmw device +0  デバイス番号 0 の仮想デバイスを接続します
    vmw device -a  全ての仮想デバイスを切断します


コマンド "hwver"
================

  vmw [<共通オプション>] hwver

    仮想マシンの仮想ハードウェアバージョンを表示します

    現在わかっている以下の仮想ハードウェアバージョンは以下のとおりです：

     1  WS 2.x で作成された VM

     2  WS 3.x で作成された VM (および、多分 GSX 2.x, ESX 1.x)

     3  WS 4.x で作成された VM (および、多分 GSX 3.x, ESX 2.x, ACE 1.x)
        または WS 5.x で "legacy" として作成された VM

     4  WS 5.x で作成された VM


コマンド "memory"
=================

  vmw [<共通オプション>] memory

    VM に割り当てられたメモリのサイズを MB で表示します


コマンド "mhz"
==============

  vmw [<共通オプション>] mhz

    プロセッサ速度をメガヘルツで表示します.


コマンド "option"
=================

  vmw [<共通オプション>] option [[+|-|/]<options>]

    VMware GUI オプション設定を取得・設定します

    +    <options> で指定されたオプションを有効にします

    -    <options> で指定されたオプションを無効にします

    /    <options> で指定されたオプションの設定を逆にします

    <options> には、以下の VMware GUI オプションを指定します:

      g  grab input when cursor enters window

      u  ungrab input when cursor leaves window

      s  scroll when cursor approaches window edge

      c  copy and paste between host and guest

      t  time syncronization between host and guest

    +, -, / のいずれも指定されなかった場合、現在の GUI オプション設定を表示
    します。

    "copy and paste" 設定は、本プログラムの "copy" "paste" コマンドに影響し
    ます。この設定によってバックドアファンクションの動作が変わるためです。

    "time synchronization" 設定は、本プログラムの "time" コマンドに影響しま
    せん。この設定はバックドアファンクションの動作を変えません。
    おそらくこのオプション設定は、正規の VMwareTool が時刻の同期をするかしな
    いかを決めるためのフラグとしてのみ使用されているのだと思われます。

  例:

    vmw option      現在のオプション設定を表示します
    vmw option +c   copy & paste を有効にします


コマンド "paste"
================

  vmw paste [<共通オプション>][<file>]

    ホストのクリップボードからテキストを取得します

    <file>     取得したテキストを出力するファイルを指定します
               省略した場合、テキストは標準出力に出力されます
               この場合の出力は -q オプションの影響を受けません

  例:

    vmw paste host.txt  テキストを "host.txt" ファイルに保存します
    vmw paste | more    テキストを "more" プログラムで閲覧します


コマンド "rpc"
==============

  vmw rpc [<共通オプション>[-e] <rpc command>

    ゲスト・ホスト間 RPC ファンクションを実行します

    -e             WS4.0/GSX3.2 以降で、エンハンスト RPC を使用します

    <rpc command>  ホストに送信する RPC コマンドテキスト
                   空白文字を含む場合、"" で括ります


    以下の RPC コマンドが現在知られています：

      machine.id.get
          VM に設定された machine.id テキストを取得します

      log <message>
          ホスト内の vmware.log ファイルに <message> を出力します

      info-set guestinfo.<varname> <value>
      info-get guestinfo.<varname>
          使用目的は不明です

      tools.set.version <version>
          VMware に VMwareTools バージョンを通知します。
          VMware はこのバージョン番号を元にステータス領域にメッセージを
          表示します

      disk.wiper.enable
          仮想ディスクシュリンクが可能かどうかをチェックします

      disk.shrink
          仮想ディスクシュリンク処理を開始します


コマンド "screen"
=================

  vmw screen [<共通オプション>]

    ホストの画面解像度をピクセルで取得します


コマンド "time"
===============

  vmw time [<共通オプション>][-u|-U][{-r|-R}[<interval>]][-g]

    ホストのシステム時刻を表示・ゲストのシステム時刻を同期します

    -u  ローカル時刻を使用してゲストのシステム時刻を更新します

    -U  GMT を使用してゲストのシステム時刻を更新します

    上記のいずれも指定されなかった場合、ゲストシステム時刻の更新は行われずに
    ホストのシステム時刻が表示されます。
    -u と -U の違いは、unix ゲストでのみ意味を持ちます。
    DOS では、システム時刻は常にローカル時刻で設定されます。
    Windows では、システム時刻は常に GMT で設定されます。

    -r  <interval> 秒間隔で繰り返します (デフォルト: 60 秒)

    -R  -r と同じですが、ターミナルの改行を抑制します。

    -g  時刻を GMT で表示します。このオプションが指定されない場合、ローカル
        時刻が表示されます。


  例:

    vmw time           ホストのシステム時刻を表示します
    vmw time -q -r -U  GMT を使用して 60 秒間隔で同期を行います
                       時刻の表示は行いません


コマンド "uuid"
===============

  vmw uuid [<共通オプション>]

    仮想マシンの BIOS UUID を表示します


コマンド "version"
==================

  vmw version [<共通オプション>]

    VMware プロダクト種別と内部バージョン番号を表示します。
    この場合のバージョン番号は、VMware プロダクトのバージョン番号
    （"Workstation 5.0" "ESX Server 1.0" など）とは無関係です。
    現在知られている限りでは常に 6 です。

    また、プロダクト種別も現在の VMware プロダクト構成とはかけ離れてきて、
    あまり意味がなくなってきています。
    現在知られているプロダクト種別は以下のとおりです：

      1   VMware Express
      2   VMware ESX Server
      3   VMware GSX Server
      4   VMware Workstation
